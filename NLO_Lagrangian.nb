(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[      8638,        251]
NotebookOptionsPosition[      7824,        232]
NotebookOutlinePosition[      8214,        248]
CellTagsIndexPosition[      8171,        245]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{"NotebookSave", "[", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"s", ":=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"PauliMatrix", "[", "i", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", " ", "1", ",", " ", "3"}], "}"}]}], "]"}]}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{"one", " ", ":=", " ", 
  RowBox[{"PauliMatrix", "[", "0", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"pi", ":=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     SubscriptBox["\[Pi]", "i"], "[", "x", "]"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"i", ",", " ", "1", ",", " ", "3"}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"v", " ", "=", " ", 
   RowBox[{
    RowBox[{"1", "/", "2"}], "*", " ", "\[Mu]", " ", "*", "\[Delta]", "*", 
    RowBox[{"s", "[", 
     RowBox[{"[", "3", "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vars", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
    "f", ",", " ", "\[Alpha]", ",", " ", "\[Mu]", " ", ",", "\[Delta]", ",", 
     " ", "y", ",", " ", "pi", ",", 
     RowBox[{
      SubscriptBox["\[PartialD]", "x"], "pi"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"$Assumptions", " ", "=", " ", 
  RowBox[{"vars", " ", "\[Element]", "Reals"}]}]}], "Input",
 CellChangeTimes->{{3.839994358485491*^9, 3.839994358645206*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"d2d5dd18-0f20-49ed-a4de-78b60b16cd57"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"dot", "[", 
    RowBox[{"A_", ",", " ", "n_"}], "]"}], " ", ":=", " ", 
   RowBox[{"A", ".", 
    RowBox[{"dot", "[", 
     RowBox[{"A", ",", " ", 
      RowBox[{"n", "-", "1"}]}], "]"}]}]}], ";", " ", 
  RowBox[{
   RowBox[{"dot", "[", 
    RowBox[{"A_", ",", " ", "0"}], "]"}], ":=", " ", 
   RowBox[{"IdentityMatrix", "[", 
    RowBox[{"Dimensions", "[", "A", "]"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"exp", "[", 
   RowBox[{"x_", ",", " ", "n_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Sum", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"dot", "[", 
      RowBox[{"x", ",", " ", "m"}], "]"}], "/", " ", 
     RowBox[{"(", 
      RowBox[{"m", "!"}], ")"}]}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"m", ",", " ", "0", ",", " ", "n"}], "}"}]}], "]"}]}]}], "Input",\
ExpressionUUID->"8560bf7a-597b-4e4f-9c1d-22e4581becd0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"U", "[", "n_", "]"}], " ", ":=", " ", 
  RowBox[{"exp", "[", 
   RowBox[{
    RowBox[{"I", " ", "*", 
     RowBox[{"(", 
      RowBox[{"pi", ".", "s"}], ")"}], "*", 
     RowBox[{"y", "/", 
      RowBox[{"(", 
       RowBox[{"2", "*", "f"}], ")"}]}]}], ",", " ", "n"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"A\[Alpha]", ":=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Cos", "[", 
      RowBox[{"\[Alpha]", "/", "2"}], "]"}], "*", 
     RowBox[{"IdentityMatrix", "[", 
      RowBox[{"{", 
       RowBox[{"2", ",", "2"}], "}"}], "]"}]}], " ", "+", " ", 
    RowBox[{"I", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"\[Alpha]", "/", "2"}], "]"}], "*", 
     RowBox[{"s", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}]}]}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalSigma]", "[", "n_", "]"}], " ", ":=", " ", 
  RowBox[{"A\[Alpha]", ".", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"U", "[", "n", "]"}], ".", 
     RowBox[{"U", "[", "n", "]"}]}], ")"}], ".", "A\[Alpha]"}]}]}], "Input",Ex\
pressionUUID->"10893a3c-3e60-4e06-88c8-3fdf46095e41"],

Cell[BoxData[
 RowBox[{
  RowBox[{"conj", "[", "x_", "]"}], " ", ":=", " ", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"Refine", "[", 
    RowBox[{
     RowBox[{"ConjugateTranspose", "[", "x", "]"}], ",", " ", "assum"}], 
    "]"}], "]"}]}]], "Input",ExpressionUUID->"756f9ed8-7298-4a78-be62-\
09fb73006ad2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"n", " ", "=", " ", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"expand", "[", "x_", "]"}], " ", ":=", " ", 
   RowBox[{"Normal", "[", 
    RowBox[{"Series", "[", 
     RowBox[{
      RowBox[{"Simplify", " ", "[", "x", "]"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"y", ",", " ", "0", ",", "n"}], "}"}]}], "]"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalSigma]n", "=", " ", 
   RowBox[{"\[CapitalSigma]", "[", "n", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[CapitalSigma]n", "=", " ", 
    RowBox[{"expand", "[", "\[CapitalSigma]n", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalSigma]nconj", " ", "=", " ", 
   RowBox[{"conj", "[", "\[CapitalSigma]n", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[CapitalSigma]nconj", " ", "=", " ", 
    RowBox[{"expand", "[", "\[CapitalSigma]nconj", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"d\[CapitalSigma]n", " ", "=", " ", 
   RowBox[{
    SubscriptBox["\[PartialD]", "x"], "\[CapitalSigma]n"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"d\[CapitalSigma]n", " ", "=", " ", 
    RowBox[{"expand", "[", 
     RowBox[{
      SubscriptBox["\[PartialD]", "x"], "\[CapitalSigma]n"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"d\[CapitalSigma]nconj", " ", "=", " ", 
   RowBox[{"conj", "[", "d\[CapitalSigma]n", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"d\[CapitalSigma]nconj", " ", "=", " ", 
    RowBox[{"expand", "[", "d\[CapitalSigma]nconj", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"com", " ", "=", " ", 
   RowBox[{
    RowBox[{"v", ".", "\[CapitalSigma]n"}], " ", "-", " ", 
    RowBox[{"\[CapitalSigma]n", ".", "v"}]}]}], ";"}], "\[IndentingNewLine]", 

 RowBox[{
  RowBox[{
   RowBox[{"com", " ", "=", " ", 
    RowBox[{"expand", "[", "com", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"comconj", " ", "=", " ", 
   RowBox[{"conj", "[", "com", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"comconj", " ", "=", " ", 
   RowBox[{"expand", "[", "comconj", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.839994400698874*^9, 
  3.8399944007395277`*^9}},ExpressionUUID->"0434cf25-69a5-4cbc-a851-\
7af2a6f207f7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[CapitalSigma]n", "=", " ", 
   RowBox[{"expand", "[", "\[CapitalSigma]n", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalSigma]nconj", " ", "=", " ", 
   RowBox[{"expand", "[", "\[CapitalSigma]nconj", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"d\[CapitalSigma]n", " ", "=", " ", 
   RowBox[{"expand", "[", 
    RowBox[{
     SubscriptBox["\[PartialD]", "x"], "\[CapitalSigma]n"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"d\[CapitalSigma]nconj", " ", "=", " ", 
   RowBox[{"expand", "[", "d\[CapitalSigma]nconj", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"com", " ", "=", " ", 
   RowBox[{"expand", "[", "com", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"comconj", " ", "=", " ", 
   RowBox[{"expand", "[", "comconj", "]"}]}], ";"}]}], "Input",ExpressionUUID->\
"677ab458-9797-45c6-8ed6-6fcdf04f2ea1"]
},
WindowSize->{630., 739.5},
WindowMargins->{{0, Automatic}, {0, Automatic}},
FrontEndVersion->"12.3 for Linux x86 (64-bit) (July 9, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"f738d708-0446-4842-92d1-db105609293a"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 1438, 38, 154, "Input",ExpressionUUID->"d2d5dd18-0f20-49ed-a4de-78b60b16cd57"],
Cell[1999, 60, 891, 26, 71, "Input",ExpressionUUID->"8560bf7a-597b-4e4f-9c1d-22e4581becd0"],
Cell[2893, 88, 1117, 33, 73, "Input",ExpressionUUID->"10893a3c-3e60-4e06-88c8-3fdf46095e41"],
Cell[4013, 123, 309, 8, 29, "Input",ExpressionUUID->"756f9ed8-7298-4a78-be62-09fb73006ad2"],
Cell[4325, 133, 2545, 70, 422, "Input",ExpressionUUID->"0434cf25-69a5-4cbc-a851-7af2a6f207f7"],
Cell[6873, 205, 947, 25, 133, "Input",ExpressionUUID->"677ab458-9797-45c6-8ed6-6fcdf04f2ea1"]
}
]
*)

